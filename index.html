<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>CircularKheti ‚Äì Feedback & Preorder</title>

<style>
body{margin:0;font-family:Arial;background:#f6fff8}
.screen{display:none;padding:20px;min-height:100vh}
.active{display:block}
h2{text-align:center}

input,select{
width:100%;padding:12px;margin-top:10px;
border-radius:10px;border:1px solid #ccc
}

.error{color:red;font-size:13px}

.btn{
background:#4CAF50;color:#fff;border:0;
width:100%;padding:14px;border-radius:12px;
font-size:16px;margin-top:15px
}
.btn:disabled{background:#9e9e9e}

.btn.back{background:#757575}

.star span{font-size:28px;color:#ccc;cursor:pointer}
.star .on{color:#fbc02d}

.tabs{display:flex;gap:10px;margin-top:20px}
.tab{
flex:1;text-align:center;padding:12px;
background:#e8f5e9;border-radius:10px
}
.tab.active{background:#4CAF50;color:white}

.footer{
position:fixed;bottom:10px;width:100%;
text-align:center
}
.footer img{height:35px}
.lock{background:#eee}
</style>
</head>

<body>

<!-- THANK YOU -->
<div id="thanks" class="screen">
<h2>‚úÖ Success</h2>
<p style="text-align:center">Saved successfully</p>
</div>

<!-- FEEDBACK -->
<div class="screen active" id="f1">
<h2>üçà Feedback</h2>

<input id="fname" placeholder="Your Name">
<div class="error" id="nameErr"></div>

<input id="fmobile" placeholder="WhatsApp Number">
<div class="error" id="mobErr"></div>

<h3>Taste *</h3><div class="star" id="taste"></div>
<h3>Softness *</h3><div class="star" id="soft"></div>
<h3>Overall *</h3><div class="star" id="overall"></div>
<div class="error" id="rateErr"></div>

<button class="btn" id="fsubmit" disabled>Submit</button>

<div class="footer">
<img src="CK logo.png.jpg" onclick="goInfo()">
</div>
</div>

<!-- CHOICE -->
<div class="screen" id="choice">
<h2>Next Step</h2>

<div class="tabs">
<div class="tab active" onclick="openShare()">Share</div>
<div class="tab" onclick="openPreorder()">Preorder</div>
</div>

<div id="share">
<input id="link">
<button class="btn" onclick="copy()">Copy Link</button>
</div>

<button class="btn back" onclick="goBack()">‚¨Ö Back</button>

<div class="footer">
<img src="CK logo.png.jpg" onclick="goInfo()">
</div>
</div>

<!-- PREORDER -->
<div class="screen" id="p1">
<h2>Preorder</h2>

<input id="pname" class="lock">
<input id="pmobile" class="lock">

<select id="pcity">
<option value="">City *</option>
<option>Pune</option>
<option>Mumbai</option>
<option>Nashik</option>
</select>
<div class="error" id="cityErr"></div>

<select id="pplace">
<option value="">Place *</option>
<option>Society A</option>
<option>Society B</option>
</select>
<div class="error" id="placeErr"></div>

<select id="ptype">
<option value="">Ripening *</option>
<option>Half Ripen</option>
<option>Fully Ripen</option>
</select>
<div class="error" id="typeErr"></div>

<p><b>Payment:</b> CASH / UPI on delivery</p>

<button class="btn" id="psubmit">Confirm Preorder</button>
<button class="btn back" onclick="goBack()">‚¨Ö Back</button>

<div class="footer">
<img src="CK logo.png.jpg" onclick="goInfo()">
</div>
</div>

<!-- INFO -->
<div class="screen" id="info">
<h2>üå± About CircularKheti</h2>
<p>Direct farmer model. Fresh harvest.</p>
<button class="btn back" onclick="goBack()">‚¨Ö Back</button>
</div>

<script>
let ratings={},historyStack=["f1"];

function createStars(id){
let d=document.getElementById(id);
for(let i=1;i<=5;i++){
 let s=document.createElement("span");
 s.innerHTML="‚òÖ";
 s.onclick=()=>{
 ratings[id]=i;
 d.querySelectorAll("span").forEach(x=>x.classList.remove("on"));
 for(let j=0;j<i;j++)d.children[j].classList.add("on");
 validateFeedback();
 }
 d.appendChild(s);
}
}
["taste","soft","overall"].forEach(createStars);

/* VALIDATION */

fname.oninput=fmobile.oninput=validateFeedback;

function validateFeedback(){
let ok=true;

/* Name */
if(fname.value.length<3 || /\d/.test(fname.value)){
 nameErr.innerText="Enter valid name";
 ok=false;
}else nameErr.innerText="";

/* Mobile */
if(!/^[6-9]\d{9}$/.test(fmobile.value)){
 mobErr.innerText="Enter valid 10-digit mobile";
 ok=false;
}else mobErr.innerText="";

/* Ratings */
if(!ratings.taste||!ratings.soft||!ratings.overall){
 rateErr.innerText="Please rate all fields";
 ok=false;
}else rateErr.innerText="";

fsubmit.disabled=!ok;
}

fsubmit.onclick=()=>{
saveLocal("feedback",{
 name:fname.value.trim(),
 mobile:fmobile.value,
 ratings,
 time:new Date().toISOString()
});
pname.value=fname.value;
pmobile.value=fmobile.value;
pname.readOnly=true;
pmobile.readOnly=true;
link.value=location.href;
navigate("choice");
};

/* PREORDER VALIDATION */
psubmit.onclick=()=>{
let ok=true;
if(!pcity.value){cityErr.innerText="Required";ok=false}
else cityErr.innerText="";
if(!pplace.value){placeErr.innerText="Required";ok=false}
else placeErr.innerText="";
if(!ptype.value){typeErr.innerText="Required";ok=false}
else typeErr.innerText="";

if(!ok)return;

saveLocal("preorder",{
 name:pname.value,
 mobile:pmobile.value,
 city:pcity.value,
 place:pplace.value,
 type:ptype.value,
 time:new Date().toISOString()
});
alert("Preorder saved successfully");
};

/* STORAGE */
function saveLocal(k,d){
let arr=JSON.parse(localStorage.getItem(k)||"[]");
arr.push(d);
localStorage.setItem(k,JSON.stringify(arr));
}

/* NAVIGATION */
function show(id){
document.querySelectorAll(".screen")
.forEach(x=>x.classList.remove("active"));
document.getElementById(id).classList.add("active");
}
function navigate(id){historyStack.push(id);show(id)}
function goBack(){
if(historyStack.length>1){
historyStack.pop();
show(historyStack[historyStack.length-1]);
}
}

function openShare(){setTab(0);navigate("choice")}
function openPreorder(){setTab(1);navigate("p1")}

function setTab(i){
document.querySelectorAll(".tab")
.forEach(x=>x.classList.remove("active"));
document.querySelectorAll(".tab")[i]
.classList.add("active");
}

function copy(){
navigator.clipboard.writeText(link.value);
alert("Link copied!");
}

function goInfo(){navigate("info")}
</script>

</body>
</html>

